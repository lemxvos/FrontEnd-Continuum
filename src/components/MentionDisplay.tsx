/**\n * MENTION DISPLAY\n * \n * Renderiza men√ß√µes em um texto\n * \n * ENTRADA:\n * - content: \"Sa√≠ com {person:ent_8f2a} e {project:ent_91ab}\"\n * - entities: [{ id: \"ent_8f2a\", name: \"Emilly\", icon: \"üë©\" }, ...]\n * \n * SA√çDA:\n * \"Sa√≠ com [üë© Emilly] e [üìä Projeto X]\"\n * \n * REGRA:\n * - Recebe entidades J√Å PROCESSADAS pelo backend\n * - Apenas renderiza como chips/badges\n * - Totalmente determin√≠stico\n */\n\nimport { useMentionTokens } from \"@/hooks/useMentions\";\nimport { Entity } from \"@/types/models\";\nimport { EntityBadge } from \"./EntityBadge\";\n\ninterface MentionDisplayProps {\n  content: string;\n  entities: Entity[];\n  className?: string;\n  onEntityClick?: (entity: Entity) => void;\n}\n\nexport function MentionDisplay({\n  content,\n  entities,\n  className = \"\",\n  onEntityClick,\n}: MentionDisplayProps) {\n  const tokens = useMentionTokens(content);\n\n  // Map para buscar entidades por seu reference {type:id}\n  const entityMap = new Map(\n    entities.map((e) => [`${e.type}:${e.id}`, e])\n  );\n\n  return (\n    <div className={`prose prose-sm max-w-none break-words ${className}`}>\n      {tokens.map((token, idx) => {\n        if (token.type === \"text\") {\n          return (\n            <span key={idx} className=\"whitespace-pre-wrap\">\n              {token.value}\n            </span>\n          );\n        }\n\n        // √â uma men√ß√£o\n        if (token.entity) {\n          const key = `${token.entity.type}:${token.entity.id}`;\n          const entity = entityMap.get(key);\n\n          // Se n√£o encontrou a entidade, apenas mostra o raw mention\n          if (!entity) {\n            return <span key={idx} className=\"text-gray-400\">{token.value}</span>;\n          }\n\n          // Renderiza como badge\n          return (\n            <EntityBadge\n              key={idx}\n              entity={entity}\n              onClick={() => onEntityClick?.(entity)}\n            />\n          );\n        }\n\n        return null;\n      })}\n    </div>\n  );\n}\n